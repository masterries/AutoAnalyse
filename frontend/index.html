<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoScout24 Luxembourg - Daten Analyse</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sql.js@1.8.0/dist/sql-wasm.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1><i class="fas fa-car"></i> AutoScout24 Luxembourg Analyse</h1>
                <p class="subtitle">Live-Datenanalyse von Fahrzeuglistings</p>
                <div class="status" id="status">
                    <i class="fas fa-spinner fa-spin"></i> Lade Datenbank...
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="nav-tabs">
            <button class="tab-btn active" onclick="showTab('overview')">
                <i class="fas fa-chart-pie"></i> Übersicht
            </button>
            <button class="tab-btn" onclick="showTab('models')">
                <i class="fas fa-cars"></i> Fahrzeugmodelle
            </button>
            <button class="tab-btn" onclick="showTab('prices')">
                <i class="fas fa-euro-sign"></i> Preisanalyse
            </button>
            <button class="tab-btn" onclick="showTab('trends')">
                <i class="fas fa-chart-line"></i> Trends
            </button>
            <button class="tab-btn" onclick="showTab('analysis')">
                <i class="fas fa-chart-area"></i> Erweiterte Analysen
            </button>
            <button class="tab-btn" onclick="showTab('search')">
                <i class="fas fa-search"></i> Suche
            </button>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            
            <!-- Overview Tab -->
            <div id="overview-tab" class="tab-content active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-car"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="total-listings">-</h3>
                            <p>Gesamte Listings</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-tags"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="total-models">-</h3>
                            <p>Fahrzeugmodelle</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-euro-sign"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="avg-price">-</h3>
                            <p>Durchschnittspreis</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-calendar"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="last-update">-</h3>
                            <p>Letztes Update</p>
                        </div>
                    </div>
                </div>

                <div class="charts-grid">
                    <div class="chart-container">
                        <h3>Preisverteilung nach Modell</h3>
                        <canvas id="priceDistributionChart"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <h3>Kraftstofftypen</h3>
                        <canvas id="fuelTypesChart"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <h3>Verkäufertypen</h3>
                        <canvas id="sellerTypesChart"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <h3>Listings pro Modell</h3>
                        <canvas id="listingsPerModelChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Models Tab -->
            <div id="models-tab" class="tab-content">
                <div class="filter-bar">
                    <input type="text" id="model-search" placeholder="Nach Modell suchen..." />
                    <select id="sort-by">
                        <option value="listings">Sortieren nach Listings</option>
                        <option value="price">Sortieren nach Preis</option>
                        <option value="name">Sortieren nach Name</option>
                    </select>
                </div>
                <div id="models-grid" class="models-grid"></div>
            </div>

            <!-- Prices Tab -->
            <div id="prices-tab" class="tab-content">
                <div class="price-analysis">
                    <div class="price-stats">
                        <h3>Preisstatistiken</h3>
                        <div id="price-stats-content"></div>
                    </div>
                    
                    <div class="chart-container">
                        <h3>Preishistogramm</h3>
                        <canvas id="priceHistogramChart"></canvas>
                    </div>
                    
                    <div class="cheapest-listings">
                        <h3>Günstigste Angebote</h3>
                        <div id="cheapest-listings-table"></div>
                    </div>
                </div>
            </div>

            <!-- Trends Tab -->
            <div id="trends-tab" class="tab-content">
                <div class="trends-analysis">
                    <div class="chart-container">
                        <h3>Preisänderungen über Zeit</h3>
                        <canvas id="priceChangesChart"></canvas>
                    </div>
                    
                    <div class="recent-changes">
                        <h3>Aktuelle Preisänderungen</h3>
                        <div id="recent-changes-table"></div>
                    </div>
                </div>
            </div>

            <!-- Analysis Tab -->
            <div id="analysis-tab" class="tab-content">
                <div class="analysis-section">
                    <!-- Age vs Mileage Analysis -->
                    <div class="chart-container full-width">
                        <h3>Baujahr vs. Kilometerstand Analyse</h3>
                        <canvas id="ageVsMileageChart"></canvas>
                    </div>
                    
                    <!-- Price Correlation Analysis -->
                    <div class="charts-grid">
                        <div class="chart-container">
                            <h3>Preis vs. Baujahr</h3>
                            <canvas id="priceVsAgeChart"></canvas>
                        </div>
                        
                        <div class="chart-container">
                            <h3>Preis vs. Kilometerstand</h3>
                            <canvas id="priceVsMileageChart"></canvas>
                        </div>
                    </div>
                    
                    <!-- Dealer vs Private Analysis -->
                    <div class="dealer-analysis">
                        <h3>Händler vs. Privat Vergleich</h3>
                        <div class="dealer-stats-grid">
                            <div class="dealer-card">
                                <div class="dealer-header dealer">
                                    <i class="fas fa-store"></i>
                                    <h4>Händler</h4>
                                </div>
                                <div class="dealer-stats" id="dealer-stats"></div>
                            </div>
                            
                            <div class="dealer-card">
                                <div class="dealer-header private">
                                    <i class="fas fa-user"></i>
                                    <h4>Privat</h4>
                                </div>
                                <div class="dealer-stats" id="private-stats"></div>
                            </div>
                        </div>
                        
                        <div class="charts-grid mt-3">
                            <div class="chart-container">
                                <h3>Preisverteilung: Händler vs. Privat</h3>
                                <canvas id="dealerVsPrivatePriceChart"></canvas>
                            </div>
                            
                            <div class="chart-container">
                                <h3>Durchschnittspreise nach Verkäufertyp</h3>
                                <canvas id="avgPriceBySellerChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Age Distribution Analysis -->
                    <div class="charts-grid">
                        <div class="chart-container">
                            <h3>Baujahr-Verteilung</h3>
                            <canvas id="ageDistributionChart"></canvas>
                        </div>
                        
                        <div class="chart-container">
                            <h3>Kilometer-Verteilung</h3>
                            <canvas id="mileageDistributionChart"></canvas>
                        </div>
                    </div>
                    
                    <!-- Value Analysis -->
                    <div class="value-analysis">
                        <h3>Wertverlust-Analyse</h3>
                        <div class="value-insights" id="value-insights"></div>
                        <div class="chart-container">
                            <h3>Wertverlust nach Modell und Alter</h3>
                            <canvas id="depreciationChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Search Tab -->
            <div id="search-tab" class="tab-content">
                <div class="search-section">
                    <div class="search-filters">
                        <h3>Suchfilter</h3>
                        <div class="filter-group">
                            <label>Marke:</label>
                            <select id="search-make">
                                <option value="">Alle Marken</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label>Modell:</label>
                            <select id="search-model">
                                <option value="">Alle Modelle</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label>Kraftstoff:</label>
                            <select id="search-fuel">
                                <option value="">Alle Kraftstofftypen</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label>Preis von:</label>
                            <input type="number" id="price-min" placeholder="Min. Preis">
                        </div>
                        
                        <div class="filter-group">
                            <label>Preis bis:</label>
                            <input type="number" id="price-max" placeholder="Max. Preis">
                        </div>
                        
                        <button class="search-btn" onclick="performSearch()">
                            <i class="fas fa-search"></i> Suchen
                        </button>
                    </div>
                    
                    <div class="search-results">
                        <h3>Suchergebnisse <span id="results-count"></span></h3>
                        <div id="search-results-table"></div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <script src="app.js"></script>
</body>
</html>
